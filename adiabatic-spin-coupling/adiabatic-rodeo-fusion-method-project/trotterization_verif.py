import numpy as np
import matplotlib.pyplot as plt
import matplotlib

delta_1 = np.array([np.float64(0.8972135954999578), np.complex128(0.8972135954999576+0j), np.complex128(0.8972135954999576+0j), np.complex128(0.9003285962961788+0j), np.complex128(0.9165264327085008+0j), np.complex128(0.9209222861420686+0j), np.complex128(0.9262769447531263+0j), np.complex128(0.9418140970796081+0j), np.complex128(0.9494306229321203+0j), np.complex128(0.9570112684110058+0j), np.complex128(0.9688461852599122+0j), np.complex128(0.975945455629246+0j), np.complex128(0.9821784310048177+0j), np.complex128(0.9888327049333918+0j), np.complex128(0.9931393962486263+0j), np.complex128(0.9960709133503524+0j), np.complex128(0.9981604761662578+0j), np.complex128(0.9993579539864446+0j), np.complex128(0.9995115357518637+0j), np.complex128(0.9990647234918848+0j), np.complex128(0.9983494449058932+0j), np.complex128(0.9976068926015631+0j), np.complex128(0.9967308489031148+0j), np.complex128(0.995686962873504+0j), np.complex128(0.995580330321304+0j), np.complex128(0.9954335025011719+0j), np.complex128(0.9950388587810647+0j), np.complex128(0.9958392791349635+0j), np.complex128(0.9964373708324678+0j), np.complex128(0.9967463693435356+0j)])
delta_0p5 = np.array([np.float64(0.8972135954999578), np.complex128(0.8972135954999576+0j), np.complex128(0.9023765004147807+0j), np.complex128(0.9052489416005868+0j), np.complex128(0.9129083882553164+0j), np.complex128(0.9217909141221992+0j), np.complex128(0.9295731975757562+0j), np.complex128(0.9393113463704246+0j), np.complex128(0.9498254840557926+0j), np.complex128(0.9588305810950692+0j), np.complex128(0.9675857880350448+0j), np.complex128(0.976177830634125+0j), np.complex128(0.9829984364709429+0j), np.complex128(0.9886107038465867+0j), np.complex128(0.9932412443910246+0j), np.complex128(0.9963817832718339+0j), np.complex128(0.9984343145372383+0j), np.complex128(0.9994218394359274+0j), np.complex128(0.9996155591489395+0j), np.complex128(0.9992634630025922+0j), np.complex128(0.9984973327425091+0j), np.complex128(0.9976200757618786+0j), np.complex128(0.9967156497165502+0j), np.complex128(0.9959546452497416+0j), np.complex128(0.9955446232400298+0j), np.complex128(0.9953168199350787+0j), np.complex128(0.9953410984417147+0j), np.complex128(0.9958027706858917+0j), np.complex128(0.996346309713903+0j), np.complex128(0.9969578297545076+0j)])
delta_0p1 = np.array([np.float64(0.8972135954999578), np.complex128(0.8983022931104885+0j), np.complex128(0.9013042352878943+0j), np.complex128(0.9063586554446269+0j), np.complex128(0.9129729550337984+0j), np.complex128(0.9209884567510978+0j), np.complex128(0.9299962613122621+0j), np.complex128(0.9395596983033637+0j), np.complex128(0.949370958455868+0j), np.complex128(0.9588902092500036+0j), np.complex128(0.9679200569091175+0j), np.complex128(0.9760117787147928+0j), np.complex128(0.9830384307744899+0j), np.complex128(0.9887973037434301+0j), np.complex128(0.993260358167853+0j), np.complex128(0.9964483249383911+0j), np.complex128(0.9984651928738011+0j), np.complex128(0.9994714765221376+0j), np.complex128(0.9996715669409609+0j), np.complex128(0.9992823149681807+0j), np.complex128(0.9985305304452903+0j), np.complex128(0.9976223157485484+0j), np.complex128(0.9967305627175042+0j), np.complex128(0.9959972127222977+0j), np.complex128(0.9955079179608779+0j), np.complex128(0.9953108441262198+0j), np.complex128(0.9954106722896716+0j), np.complex128(0.9957684370764978+0j), np.complex128(0.9963353076058075+0j), np.complex128(0.9970223454422024+0j)])
delta_0p05 = np.array([np.float64(0.8972135954999578), np.complex128(0.8982482075096581+0j), np.complex128(0.901344492520673+0j), np.complex128(0.9063340276551668+0j), np.complex128(0.9129846282098387+0j), np.complex128(0.9209899562781776+0j), np.complex128(0.9299870686335108+0j), np.complex128(0.9395776848233037+0j), np.complex128(0.949351971829435+0j), np.complex128(0.9589132634393258+0j), np.complex128(0.9679044383357165+0j), np.complex128(0.9760232425801554+0j), np.complex128(0.983036056297925+0j), np.complex128(0.9888005893043774+0j), np.complex128(0.9932621677765784+0j), np.complex128(0.996449902619406+0j), np.complex128(0.9984665646559319+0j), np.complex128(0.9994734504410557+0j), np.complex128(0.999671952420903+0j), np.complex128(0.9992837424741841+0j), np.complex128(0.9985315096944696+0j), np.complex128(0.9976221427929697+0j), np.complex128(0.9967318713007559+0j), np.complex128(0.9959968790306046+0j), np.complex128(0.9955082918923308+0j), np.complex128(0.995311540043713+0j), np.complex128(0.9954097179598397+0j), np.complex128(0.9957702143737494+0j), np.complex128(0.9963336870250583+0j), np.complex128(0.9970243461219349+0j)])
delta_0p01 = np.array([np.float64(0.8972135954999578), np.complex128(0.8982592703326102+0j), np.complex128(0.9013447525785303+0j), np.complex128(0.9063290969295281+0j), np.complex128(0.9129759678071958+0j), np.complex128(0.9209821282746982+0j), np.complex128(0.9299809890550758+0j), np.complex128(0.9395757526184532+0j), np.complex128(0.9493538111750487+0j), np.complex128(0.9589189957929752+0j), np.complex128(0.9679099743549873+0j), np.complex128(0.9760251517920249+0j), np.complex128(0.983036363085229+0j), np.complex128(0.9888006109725164+0j), np.complex128(0.9932624089715179+0j), np.complex128(0.9964504180082416+0j), np.complex128(0.9984671662911324+0j), np.complex128(0.9994739300987895+0j), np.complex128(0.9996722154484163+0j), np.complex128(0.9992839077430344+0j), np.complex128(0.9985318055119041+0j), np.complex128(0.9976223816395577+0j), np.complex128(0.9967319026640978+0j), np.complex128(0.995996628849432+0j), np.complex128(0.9955079071212267+0j), np.complex128(0.9953111125004861+0j), np.complex128(0.9954095103027495+0j), np.complex128(0.9957702587227926+0j), np.complex128(0.9963341071088745+0j), np.complex128(0.9970249862431223+0j)])


delta_1_new = np.array([np.float64(0.8972135954999578), np.complex128(0.8972135954999576+0j), np.complex128(0.8988163305778959+0j), np.complex128(0.9191402963609943+0j), np.complex128(0.9240057982913014+0j), np.complex128(0.945325147884252+0j), np.complex128(0.9546413934563038+0j), np.complex128(0.9715545468177478+0j), np.complex128(0.9804650839786943+0j), np.complex128(0.9902024464941017+0j), np.complex128(0.9953709129970991+0j), np.complex128(0.998493694716646+0j), np.complex128(0.9995855172134218+0j), np.complex128(0.9989608500012478+0j), np.complex128(0.9978687960492952+0j), np.complex128(0.9966148883884544+0j), np.complex128(0.9955546519216273+0j), np.complex128(0.9954139269237755+0j), np.complex128(0.9954536945485306+0j), np.complex128(0.9964448672949352+0j), np.complex128(0.9972866133169236+0j), np.complex128(0.9984640999386045+0j), np.complex128(0.9992222640921746+0j), np.complex128(0.9997542004717042+0j), np.complex128(0.9998841018088303+0j), np.complex128(0.9996680640435194+0j), np.complex128(0.9993191793825915+0j), np.complex128(0.998853155367401+0j), np.complex128(0.9985425853900702+0j), np.complex128(0.9983647341976644+0j), np.complex128(0.9984295449970894+0j), np.complex128(0.9986766688070912+0j), np.complex128(0.9990235854372438+0j), np.complex128(0.9994240649618625+0j), np.complex128(0.9997166392606377+0j), np.complex128(0.9999178745048276+0j), np.complex128(0.9999377613343423+0j), np.complex128(0.9998261724573119+0j), np.complex128(0.9996512061403877+0j), np.complex128(0.9994014714877509+0j), np.complex128(0.9992767445114608+0j), np.complex128(0.9991444401645553+0j), np.complex128(0.9992224085060775+0j), np.complex128(0.9993070943794626+0j), np.complex128(0.9995195334043433+0j), np.complex128(0.9997068291098339+0j), np.complex128(0.9998649167288486+0j), np.complex128(0.9999653332389846+0j), np.complex128(0.9999583289610061+0j), np.complex128(0.9998885774002149+0j), np.complex128(0.9997795577271322+0j), np.complex128(0.9996203963565199+0j), np.complex128(0.9995626434956711+0j), np.complex128(0.999461607872951+0j), np.complex128(0.9995391134311233+0j), np.complex128(0.9995681955103486+0j), np.complex128(0.9997223320004595+0j), np.complex128(0.9998240473313098+0j), np.complex128(0.9999264027207211+0j), np.complex128(0.9999839128999988+0j)])
delta_0p5_new = np.array([np.float64(0.8972135954999578), np.complex128(0.8976370760849838+0j), np.complex128(0.9044892738327425+0j), np.complex128(0.914989588610638+0j), np.complex128(0.9280960392215862+0j), np.complex128(0.9425481353104177+0j), np.complex128(0.9570280283229116+0j), np.complex128(0.9703310588019222+0j), np.complex128(0.9815175402806009+0j), np.complex128(0.9900184086507915+0j), np.complex128(0.9956756402508391+0j), np.complex128(0.9987124457899748+0j), np.complex128(0.9996437901097108+0j), np.complex128(0.9991498601958386+0j), np.complex128(0.9979404413955357+0j), np.complex128(0.9966362426500704+0j), np.complex128(0.9956859042244444+0j), np.complex128(0.9953276713451893+0j), np.complex128(0.9955951846736106+0j), np.complex128(0.99635918787465+0j), np.complex128(0.9973919053082767+0j), np.complex128(0.9984386092189307+0j), np.complex128(0.9992814930609778+0j), np.complex128(0.9997842049522562+0j), np.complex128(0.9999106640373437+0j), np.complex128(0.9997179584542202+0j), np.complex128(0.9993287721196216+0j), np.complex128(0.9988926063685821+0j), np.complex128(0.9985463128960401+0j), np.complex128(0.9983831510047335+0j), np.complex128(0.9984363798651525+0j), np.complex128(0.998679289933541+0j), np.complex128(0.9990395872770684+0j), np.complex128(0.9994230021788844+0j), np.complex128(0.9997394355873875+0j), np.complex128(0.9999250783854736+0j), np.complex128(0.9999555750773345+0j), np.complex128(0.9998479617846854+0j), np.complex128(0.9996520726563464+0j), np.complex128(0.9994346249154096+0j), np.complex128(0.9992606747722437+0j), np.complex128(0.9991773161680938+0j), np.complex128(0.9992034615159527+0j), np.complex128(0.9993276767112487+0j), np.complex128(0.9995138751523724+0j), np.complex128(0.9997127517156292+0j), np.complex128(0.9998755935052357+0j), np.complex128(0.9999667849257525+0j), np.complex128(0.9999719427871846+0j), np.complex128(0.9998999577477835+0j), np.complex128(0.9997788968594943+0j), np.complex128(0.9996472882623502+0j), np.complex128(0.9995433704869763+0j), np.complex128(0.9994952122735764+0j), np.complex128(0.999514170122961+0j), np.complex128(0.9995931211061699+0j), np.complex128(0.9997095912650305+0j), np.complex128(0.999832644315923+0j), np.complex128(0.9999315097171018+0j), np.complex128(0.9999836120479605+0j)])
delta_0p1_new = np.array([np.float64(0.8972135954999578), np.complex128(0.8994338023319368+0j), np.complex128(0.9060225555674069+0j), np.complex128(0.9162330886801712+0j), np.complex128(0.9290518225712978+0j), np.complex128(0.9432422604112726+0j), np.complex128(0.9575035378295211+0j), np.complex128(0.970639333682952+0j), np.complex128(0.9817095850919823+0j), np.complex128(0.9901376973299377+0j), np.complex128(0.9957537595094468+0j), np.complex128(0.9987680314940021+0j), np.complex128(0.9996840970487482+0j), np.complex128(0.9991751517817145+0j), np.complex128(0.9979514055235114+0j), np.complex128(0.9966343383618224+0j), np.complex128(0.9956740953031593+0j), np.complex128(0.9953103750145414+0j), np.complex128(0.9955775546681902+0j), np.complex128(0.9963460170510903+0j), np.complex128(0.9973865113401967+0j), np.complex128(0.998442048586124+0j), np.complex128(0.9992923418925244+0j), np.complex128(0.9997989783437733+0j), np.complex128(0.9999246204800053+0j), np.complex128(0.9997267539644354+0j), np.complex128(0.9993301572170418+0j), np.complex128(0.9988864623962456+0j), np.complex128(0.9985343629708237+0j), np.complex128(0.9983683004795522+0j), np.complex128(0.9984218815831589+0j), np.complex128(0.9986679409354067+0j), np.complex128(0.9990331307613814+0j), np.complex128(0.9994218435228919+0j), np.complex128(0.9997427003264923+0j), np.complex128(0.9999309610486409+0j), np.complex128(0.9999617763318375+0j), np.complex128(0.999852581422385+0j), np.complex128(0.9996541837894507+0j), np.complex128(0.9994342240004508+0j), np.complex128(0.9992584503948854+0j), np.complex128(0.9991742932857893+0j), np.complex128(0.9992006441653438+0j), np.complex128(0.999325787124437+0j), np.complex128(0.9995132399233306+0j), np.complex128(0.9997133330127321+0j), np.complex128(0.9998771209313431+0j), np.complex128(0.9999689219436634+0j), np.complex128(0.9999743592816209+0j), np.complex128(0.9999026535735134+0j), np.complex128(0.9997821642423251+0j), np.complex128(0.9996514686901694+0j), np.complex128(0.9995486102889848+0j), np.complex128(0.9995013013819525+0j), np.complex128(0.99952053006397+0j), np.complex128(0.9995989521524271+0j), np.complex128(0.9997141308314893+0j), np.complex128(0.9998354479278694+0j), np.complex128(0.9999326550214742+0j), np.complex128(0.999983748579432+0j)])
delta_0p05_new = np.array([np.float64(0.8972135954999578), np.complex128(0.8994732302668801+0j), np.complex128(0.9060399448116926+0j), np.complex128(0.9162314866477499+0j), np.complex128(0.9290362894724409+0j), np.complex128(0.9432189335831507+0j), np.complex128(0.9574802882700795+0j), np.complex128(0.9706304321994096+0j), np.complex128(0.9817085508560035+0j), np.complex128(0.9901396205880044+0j), np.complex128(0.9957556662516494+0j), np.complex128(0.9987688159334543+0j), np.complex128(0.999684243612251+0j), np.complex128(0.9991757989966912+0j), np.complex128(0.9979521747689797+0j), np.complex128(0.9966345222983706+0j), np.complex128(0.9956731602678525+0j), np.complex128(0.9953082306753394+0j), np.complex128(0.9955751634453656+0j), np.complex128(0.9963449272264703+0j), np.complex128(0.9973863943942978+0j), np.complex128(0.9984423907905516+0j), np.complex128(0.9992926906123167+0j), np.complex128(0.9997991128327957+0j), np.complex128(0.9999246772108219+0j), np.complex128(0.9997269469657797+0j), np.complex128(0.9993303708581202+0j), np.complex128(0.9988864737844279+0j), np.complex128(0.9985339847103425+0j), np.complex128(0.9983674834149316+0j), np.complex128(0.9984210945185008+0j), np.complex128(0.9986675977889341+0j), np.complex128(0.9990331270885586+0j), np.complex128(0.9994219951330896+0j), np.complex128(0.9997428377924713+0j), np.complex128(0.9999310045223906+0j), np.complex128(0.9999618117547217+0j), np.complex128(0.9998526768413123+0j), np.complex128(0.9996542762088414+0j), np.complex128(0.9994342034259862+0j), np.complex128(0.9992582257807329+0j), np.complex128(0.9991738431856538+0j), np.complex128(0.9992002807855382+0j), np.complex128(0.9993256432025489+0j), np.complex128(0.9995132596678353+0j), np.complex128(0.9997134208624703+0j), np.complex128(0.9998771910205797+0j), np.complex128(0.9999689383575664+0j), np.complex128(0.999974385203059+0j), np.complex128(0.9999027110802055+0j), np.complex128(0.9997822113311007+0j), np.complex128(0.999651439457333+0j), np.complex128(0.9995484528751093+0j), np.complex128(0.9995010072404292+0j), np.complex128(0.9995203335576982+0j), np.complex128(0.9995988846691458+0j), np.complex128(0.9997141553866201+0j), np.complex128(0.999835505603424+0j), np.complex128(0.9999326954074138+0j), np.complex128(0.9999837543056079+0j)])
delta_0p01_new = np.array([np.float64(0.8972135954999578), np.complex128(0.8994756503752211+0j), np.complex128(0.906033077171643+0j), np.complex128(0.9162231226477912+0j), np.complex128(0.9290322688491057+0j), np.complex128(0.9432220527841471+0j), np.complex128(0.9574883482093419+0j), np.complex128(0.9706314198481574+0j), np.complex128(0.9817080013498043+0j), np.complex128(0.9901395712054102+0j), np.complex128(0.9957561598229041+0j), np.complex128(0.99876919487776+0j), np.complex128(0.9996843278831563+0j), np.complex128(0.999176084937135+0j), np.complex128(0.9979522624682399+0j), np.complex128(0.9966343457272526+0j), np.complex128(0.9956730563004401+0j), np.complex128(0.9953086894603731+0j), np.complex128(0.9955759007245822+0j), np.complex128(0.9963449582843626+0j), np.complex128(0.9973862486099062+0j), np.complex128(0.9984423667389962+0j), np.complex128(0.9992927817779994+0j), np.complex128(0.9997991775308857+0j), np.complex128(0.9999247125006617+0j), np.complex128(0.9997270230310894+0j), np.complex128(0.9993303834777654+0j), np.complex128(0.9988864130703852+0j), np.complex128(0.9985339744224172+0j), np.complex128(0.9983677007674813+0j), np.complex128(0.9984213034948899+0j), np.complex128(0.9986675869230468+0j), np.complex128(0.9990330692180658+0j), np.complex128(0.999421989067022+0j), np.complex128(0.9997428772779026+0j), np.complex128(0.9999310251873879+0j), np.complex128(0.999961833993586+0j), np.complex128(0.9998527109527351+0j), np.complex128(0.999654278409616+0j), np.complex128(0.9994341734869153+0j), np.complex128(0.9992582326707603+0j), np.complex128(0.9991739821514789+0j), np.complex128(0.9992003588233148+0j), np.complex128(0.9993256268191293+0j), np.complex128(0.9995132317246845+0j), np.complex128(0.9997134229244691+0j), np.complex128(0.9998772131334435+0j), np.complex128(0.9999689456283253+0j), np.complex128(0.9999744012305244+0j), np.complex128(0.9999027296473719+0j), np.complex128(0.9997822103339201+0j), np.complex128(0.9996514254365914+0j), np.complex128(0.999548467522561+0j), np.complex128(0.9995011086885441+0j), np.complex128(0.9995203636940214+0j), np.complex128(0.999598868608964+0j), np.complex128(0.9997141399316177+0j), np.complex128(0.9998355102626545+0j), np.complex128(0.9999327092577016+0j), np.complex128(0.9999837561530789+0j)])

def lognorm(arr):
    return np.log10(np.ones(len(arr))-arr)

x_values = np.linspace(0,30,60)

d1 = lognorm(delta_1)
d0p5 = lognorm(delta_0p5)
d0p1 = lognorm(delta_0p1)
d0p05 = lognorm(delta_0p05)
d0p01 = lognorm(delta_0p01)
d1_new = lognorm(delta_1_new)
d0p5_new = lognorm(delta_0p5_new)
d0p1_new = lognorm(delta_0p1_new)
d0p05_new = lognorm(delta_0p05_new)
d0p01_new = lognorm(delta_0p01_new)

def moving_average(x, w):
    return np.convolve(x, np.ones(w), 'valid') / w


moveav_order = 3
d1 = moving_average(d1,moveav_order)
d0p5 = moving_average(d0p5,moveav_order)
d0p1 = moving_average(d0p1,moveav_order)
d0p05 = moving_average(d0p05,moveav_order)
d0p01 = moving_average(d0p01,moveav_order)

d1_new = moving_average(d1_new,moveav_order)
d0p5_new = moving_average(d0p5_new,moveav_order)
d0p1_new = moving_average(d0p1_new,moveav_order)
d0p05_new  = moving_average(d0p05_new,moveav_order)
d0p01_new  = moving_average(d0p01_new,moveav_order)

font = {'family' : 'normal',
        'weight' : 'bold',
        'size'   : 22}

matplotlib.rc('font', **font)

ll = len(d1_new)

#plt.scatter(x_values[:ll],d1-d0p01,label="$\delta = 1$")
#plt.scatter(x_values[:ll],d0p5-d0p01,label="$\delta = 0.5$")
#plt.scatter(x_values[:ll],d0p1-d0p01,label="$\delta = 0.1$")
#plt.scatter(x_values[:ll],d0p05-d0p01,label="$\delta = 0.05$")
#plt.scatter(x_values[:ll],d0p01-d0p01,label="$\delta = 0.01$")

plt.scatter(x_values[:ll],d1_new-d0p01_new,label="$\delta = 1$")
plt.scatter(x_values[:ll],d0p5_new-d0p01_new,label="$\delta = 0.5$")
plt.scatter(x_values[:ll],d0p1_new-d0p01_new,label="$\delta = 0.1$")
plt.scatter(x_values[:ll],d0p05_new-d0p01_new,label="$\delta = 0.05$")
plt.scatter(x_values[:ll],d0p01_new-d0p01_new,label="$\delta = 0.05$")
plt.yscale("log")
plt.legend()
plt.show()

